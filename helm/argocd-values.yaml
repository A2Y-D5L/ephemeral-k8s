configs:
  cm:
    # Required for SSO/Dex callback URLs to be correct.
    # Must match how users reach Argo CD externally.
    url: https://argocd.localhost:8443

    # Argo CD bundles Dex; configure Dex connectors here.
    dex.config: |
      connectors:
      - type: ldap
        id: lldap
        name: LLDAP
        config:
          host: lldap.lldap.svc.cluster.local:3890
          insecureNoSSL: true

          # ==================================================================
          # DEV-ONLY: These are intentionally weak credentials for local use.
          # DO NOT use these values in production environments.
          # ==================================================================
          bindDN: uid=admin,ou=people,dc=example,dc=com
          bindPW: adminpwd

          usernamePrompt: Username

          userSearch:
            baseDN: ou=people,dc=example,dc=com
            # Use the uid attribute to find users. Dex will search for
            # entries where uid matches the login username.
            username: uid
            idAttr: uid
            emailAttr: mail
            nameAttr: cn

          groupSearch:
            baseDN: ou=groups,dc=example,dc=com
            # Search for groups where the user's DN is a member
            filter: "(member={{.UserDN}})"
            userMatchers:
              - userAttr: DN
                groupAttr: member
            nameAttr: cn

  # These become argocd-cmd-params-cm (runtime/flag-like settings).
  params:
    server.insecure: "true"